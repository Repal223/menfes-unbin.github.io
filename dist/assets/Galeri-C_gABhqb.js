import{r as n,g as v,q as S,o as _,x as C,c as y,a as b,j as e,d as x,n as T,s as B,f as k,h as E,k as A,p as D}from"./index-DmEEzxp2.js";function K({postId:t}){const[u,d]=n.useState(""),[m,l]=n.useState([]),[i,c]=n.useState("");n.useEffect(()=>{c(v())},[]),n.useEffect(()=>{const a=S(y(x,"galeri_comments"),C("post_id","==",t),_("created_at","asc")),f=b(a,h=>{l(h.docs.map(s=>({id:s.id,...s.data()})))});return()=>f()},[t]);const o=async()=>{const a=u.trim();a&&(await T(y(x,"galeri_comments"),{post_id:t,uid:i,isi_komentar:a.slice(0,500),from_admin:!1,created_at:B()}),d(""))};return e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{maxHeight:180,overflowY:"auto",display:"grid",gap:6},children:[m.map(a=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.6)",padding:"6px 10px",borderRadius:10},children:[e.jsx("p",{style:{margin:0,fontSize:12,opacity:.7},children:a.from_admin?"Admin":a.uid?`Anon-${String(a.uid).slice(0,6)}`:"Anon"}),e.jsx("p",{style:{margin:0},children:a.isi_komentar})]},a.id)),m.length===0&&e.jsx("div",{style:{opacity:.7},children:"Belum ada komentar"})]}),e.jsxs("div",{style:{display:"flex",gap:6,marginTop:6},children:[e.jsx("input",{value:u,onChange:a=>d(a.target.value),placeholder:"Tulis komentar...",style:{flex:1,borderRadius:10,border:"1px solid #ccc",padding:6}}),e.jsx("button",{onClick:o,style:{background:"#4B3C2D",color:"#fff",border:"none",borderRadius:10,padding:"6px 12px"},children:"Kirim"})]})]})}function L({post:t}){const[u,d]=n.useState(!1),[m,l]=n.useState(t.total_likes||0),[i,c]=n.useState(!1),[o,a]=n.useState("");n.useEffect(()=>{const s=v();a(s)},[]),n.useEffect(()=>{const s=k(x,"galeri",t.id),r=b(s,g=>{var j;if(!g.exists())return;const p=g.data();l(p.total_likes||0);const w=p.reacted_by&&o?!!((j=p.reacted_by[o])!=null&&j.heart):!1;c(w)});return()=>r()},[t.id,o]);const f=async()=>{if(!o)return;const s=k(x,"galeri",t.id),r=!i;c(r),l(g=>g+(r?1:-1));try{await E(s,{total_likes:A(r?1:-1),[`reacted_by.${o}.heart`]:r}),D()}catch{c(!r),l(p=>p+(r?-1:1))}},h=async()=>{const s=t.url;if(navigator.share)try{await navigator.share({title:t.judul,text:t.deskripsi||"",url:s})}catch{}else try{await navigator.clipboard.writeText(s),alert("Link gambar disalin")}catch{}};return e.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"20px",boxShadow:"0 5px 20px rgba(0,0,0,0.1)",overflow:"hidden",transition:"all 0.3s ease"},children:[t.url&&e.jsx("img",{src:t.url,alt:t.judul,loading:"lazy",style:{width:"100%",height:"220px",objectFit:"cover"}}),e.jsxs("div",{style:{padding:"12px"},children:[e.jsx("h3",{style:{color:"#4B3C2D"},children:t.judul}),t.deskripsi&&e.jsx("p",{style:{fontSize:"14px",opacity:.9},children:t.deskripsi}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10},children:[e.jsxs("button",{onClick:f,style:{background:"none",border:"none",cursor:"pointer",fontSize:18},children:[i?"❤️":"🤍"," ",m]}),e.jsx("button",{onClick:()=>d(s=>!s),style:{background:"none",border:"none",cursor:"pointer",fontSize:18},children:"💬"}),e.jsx("button",{onClick:h,style:{background:"none",border:"none",cursor:"pointer",fontSize:18},children:"🔗"})]}),u&&e.jsx(K,{postId:t.id})]})]})}function G(){const[t,u]=n.useState([]),[d,m]=n.useState("Semua");n.useEffect(()=>{const i=S(y(x,"galeri"),_("created_at","desc")),c=b(i,o=>{u(o.docs.map(a=>({id:a.id,...a.data()})))});return()=>c()},[]);const l=t.filter(i=>d==="Semua"||(i.kategori||"Lainnya")===d);return e.jsxs("div",{style:{background:"linear-gradient(145deg,#f8e9d8,#e1c9a6)",minHeight:"100vh",padding:"2rem"},children:[e.jsx("h1",{style:{color:"#4B3C2D",textAlign:"center",marginBottom:"0.5rem"},children:"Galeri UNBIN"}),e.jsx("p",{style:{textAlign:"center",opacity:.7},children:"Kumpulan momen terbaik mahasiswa Universitas Binaniaga Indonesia."}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:8,marginTop:8},children:["Semua","Event","Akademik","Kampus","Lainnya"].map(i=>e.jsx("button",{className:"btn",onClick:()=>m(i),style:{background:d===i?"#4B3C2D":"#8d6e63",color:"#fff"},children:i},i))}),e.jsx("div",{style:{display:"grid",gap:"20px",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",marginTop:"1.5rem"},children:l.map(i=>e.jsx(L,{post:i},i.id))})]})}export{G as default};
