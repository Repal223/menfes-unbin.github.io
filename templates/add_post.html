{% extends 'base.html' %}
{% block content %}
<h2>{{ 'Edit Menfess' if edit else 'Kirim Menfess' }}</h2>

<form class="form" method="post" action="{{ url_for('edit_post', post_id=post.id) if edit else url_for('add_post') }}">
  <input type="hidden" name="uid" value="">
  <div class="row">
    <label for="name">Nama Anonim</label>
    <input type="text" id="name" name="name" placeholder="Opsional (Anon jika kosong)" value="{{ post.name if edit else '' }}">
  </div>
  <div class="row">
    <label for="to">To</label>
    <input type="text" id="to" name="to" required placeholder="Untuk siapa pesan ini?" value="{{ post.to if edit else '' }}">
  </div>
  <div class="row">
    <label for="mood">Mood</label>
    <select id="mood" name="mood" required>
      <option value="">Pilih mood</option>
      {% set moods = ['Bahagia','Sedih','Lucu','Rindu','Galau'] %}
      {% for m in moods %}
        <option value="{{ m }}" {{ 'selected' if edit and post.mood==m else '' }}>{{ m }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="row">
    <label for="content">Isi Pesan</label>
    <textarea id="content" name="content" rows="6" required placeholder="Tulis menfess kamu...">{{ post.content if edit else '' }}</textarea>
  </div>
  <div class="actions">
    {% if edit %}
      <button type="submit" class="btn-primary">Simpan Perubahan</button>
      <a href="{{ url_for('post_detail', post_id=post.id) }}" class="btn">Batal</a>
    {% else %}
      <button type="submit" class="btn-primary">Kirim</button>
      <button type="button" id="saveDraft" class="btn">Simpan Draft</button>
      <button type="button" id="clearDraft" class="btn">Hapus Draft</button>
      <a href="{{ url_for('index') }}" class="btn">Batal</a>
    {% endif %}
  </div>
  {% if not edit %}
    <div class="hint">Draft akan tersimpan di perangkat ini saja.</div>
  {% endif %}
  
</form>
{% endblock %}
